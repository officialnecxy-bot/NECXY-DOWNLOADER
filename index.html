<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NECXY DOWNLOADER - Premium</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            red: '#FF0033',
                            dark: '#0a0a0a',
                            glass: 'rgba(255, 255, 255, 0.08)'
                        }
                    },
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                    },
                    animation: {
                        'gradient': 'gradient 8s linear infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'shimmer': 'shimmer 2s linear infinite',
                    },
                    keyframes: {
                        gradient: {
                            '0%, 100%': { 'background-position': '0% 50%' },
                            '50%': { 'background-position': '100% 50%' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        shimmer: {
                            '0%': { backgroundPosition: '-1000px 0' },
                            '100%': { backgroundPosition: '1000px 0' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #050505;
            background-image: 
                radial-gradient(circle at 15% 50%, rgba(255, 0, 51, 0.08), transparent 25%), 
                radial-gradient(circle at 85% 30%, rgba(60, 60, 255, 0.08), transparent 25%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Super Premium Glassmorphism */
        .glass-panel {
            background: rgba(18, 18, 18, 0.65);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 40px -10px rgba(0,0,0,0.7);
            transition: all 0.4s ease;
        }
        
        .glass-panel:hover {
            border-color: rgba(255, 0, 51, 0.3);
            box-shadow: 0 0 50px -10px rgba(255, 0, 51, 0.15);
        }

        .glass-header {
            background: rgba(5, 5, 5, 0.85); /* Slightly darker for better contrast */
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .glass-input {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
        }

        .glass-input:focus {
            background: rgba(0, 0, 0, 0.6);
            border-color: #FF0033;
            box-shadow: 0 0 25px rgba(255, 0, 51, 0.25), inset 0 2px 4px rgba(0,0,0,0.5);
        }

        .btn-primary {
            background: linear-gradient(135deg, #FF0033 0%, #99001f 100%);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(255, 0, 51, 0.4);
            transition: all 0.3s ease;
        }

        .btn-primary::after {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: 0.5s;
        }

        .btn-primary:hover::after {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px) scale(1.01);
            box-shadow: 0 8px 30px rgba(255, 0, 51, 0.6);
        }

        .download-btn {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.2s;
        }
        
        .download-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateX(4px);
        }
        
        ::selection {
            background: #FF0033;
            color: white;
        }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #FF0033; }
    </style>
</head>
<body class="flex flex-col">

    <!-- Header (Increased Z-Index to 100) -->
    <header class="fixed top-0 w-full z-[100] glass-header transition-all duration-300">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center relative">
            <!-- Logo -->
            <div class="flex items-center gap-3 group cursor-pointer select-none">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-brand-red to-red-900 flex items-center justify-center shadow-[0_0_15px_rgba(255,0,51,0.5)] group-hover:shadow-[0_0_25px_rgba(255,0,51,0.8)] transition-all duration-300">
                    <i class="fa-solid fa-bolt text-white text-lg group-hover:animate-pulse"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold tracking-wider text-white">NECXY <span class="text-brand-red drop-shadow-[0_0_8px_rgba(255,0,51,0.8)]">DOWNLOADER</span></h1>
                    <p class="text-[10px] text-gray-400 uppercase tracking-[0.3em] group-hover:text-white transition-colors">Premium Tools</p>
                </div>
            </div>

            <!-- Profile Button (FIXED CLICKABLE AREA) -->
            <!-- Added specific Z-index, relative positioning, and block display to ensure clickability -->
            <a href="https://profile-necxy.vercel.app/" target="_blank" class="group relative z-[101] flex items-center gap-3 px-1 pl-4 py-1 rounded-full glass-input hover:bg-white/5 border border-white/10 hover:border-brand-red/50 transition-all duration-300 hover:shadow-[0_0_20px_rgba(255,0,51,0.15)] cursor-pointer">
                <div class="text-right hidden sm:block">
                    <p class="text-xs font-bold text-white group-hover:text-brand-red transition-colors">Necxy's Profile</p>
                    <p class="text-[10px] text-gray-500 group-hover:text-gray-300 transition-colors">View Portfolio</p>
                </div>
                
                <!-- Profile Pic Container -->
                <div class="w-10 h-10 rounded-full p-[2px] bg-gradient-to-tr from-brand-red to-gray-900 group-hover:from-white group-hover:to-brand-red transition-all duration-500">
                    <img src="https://i.ibb.co/hJScbYnt/1764268446451.png" class="w-full h-full rounded-full object-cover bg-black" alt="Necxy Profile">
                </div>
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow flex flex-col items-center justify-center pt-28 pb-10 px-4 relative z-10">
        
        <!-- Animated Background Orbs -->
        <div class="absolute top-1/3 left-1/4 w-96 h-96 bg-brand-red/10 rounded-full blur-[120px] animate-pulse-slow -z-10"></div>
        <div class="absolute bottom-1/4 right-1/4 w-80 h-80 bg-blue-600/5 rounded-full blur-[100px] animate-pulse-slow -z-10" style="animation-delay: 1.5s;"></div>

        <!-- Hero Section -->
        <div class="text-center mb-10 animate-float z-10 relative">
            <div class="inline-block mb-3 px-3 py-1 rounded-full border border-white/10 bg-white/5 text-[10px] uppercase tracking-widest text-brand-red font-bold backdrop-blur-md">
                V3.1 Premium Edition
            </div>
            <h2 class="text-4xl md:text-6xl font-extrabold mb-4 text-white drop-shadow-2xl">
                Universal <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-red to-pink-600">Media Engine</span>
            </h2>
            <p class="text-gray-400 text-lg max-w-xl mx-auto font-light leading-relaxed">
                Download high-fidelity video & audio from YouTube & Instagram using NECXY's next-gen processor.
            </p>
        </div>

        <!-- Main Card -->
        <div class="w-full max-w-3xl glass-panel rounded-[32px] p-1 z-10 relative group/card">
            <div class="absolute -inset-0.5 bg-gradient-to-r from-brand-red to-purple-600 rounded-[32px] opacity-20 group-hover/card:opacity-50 blur transition duration-500"></div>
            
            <div class="relative bg-[#0a0a0a]/90 rounded-[30px] p-6 md:p-8 backdrop-blur-xl h-full">
                
                <!-- Tab Switcher -->
                <div class="flex p-1.5 bg-black/40 border border-white/5 rounded-2xl mb-8 relative shadow-inner">
                    <div id="tab-indicator" class="absolute h-[calc(100%-12px)] top-1.5 w-[calc(50%-6px)] bg-brand-red rounded-xl shadow-[0_0_15px_rgba(255,0,51,0.4)] transition-all duration-300 left-1.5"></div>
                    <button onclick="switchTab('yt')" class="flex-1 py-3 text-sm font-bold relative z-10 flex items-center justify-center gap-2 transition-colors text-white" id="btn-yt">
                        <i class="fa-brands fa-youtube text-lg"></i> YouTube
                    </button>
                    <button onclick="switchTab('ig')" class="flex-1 py-3 text-sm font-bold relative z-10 flex items-center justify-center gap-2 text-gray-500 hover:text-white transition-colors" id="btn-ig">
                        <i class="fa-brands fa-instagram text-lg"></i> Instagram
                    </button>
                </div>

                <!-- Input Area -->
                <div class="relative group mb-8">
                    <div class="absolute -inset-0.5 bg-gradient-to-r from-brand-red to-pink-600 rounded-2xl opacity-0 group-focus-within:opacity-50 transition duration-500 blur"></div>
                    <div class="relative flex items-center">
                        <input type="text" id="urlInput" placeholder="Paste YouTube Link here..." 
                               class="w-full glass-input h-16 pl-14 pr-28 rounded-2xl text-white outline-none placeholder-gray-600 font-medium text-lg">
                        <i class="fa-solid fa-link absolute left-6 text-gray-500 text-xl group-focus-within:text-brand-red transition-colors"></i>
                        
                        <button onclick="pasteLink()" class="absolute right-3 top-3 bottom-3 px-5 bg-white/5 hover:bg-white/10 border border-white/5 rounded-xl text-xs font-bold uppercase tracking-wider transition-colors hover:text-brand-red">
                            Paste
                        </button>
                    </div>
                </div>

                <!-- Generate Button -->
                <button onclick="processLink()" id="generateBtn" class="w-full btn-primary h-16 rounded-2xl font-bold text-lg uppercase tracking-[0.15em] flex items-center justify-center gap-3 group shadow-2xl">
                    <span>Analyze Media</span>
                    <i class="fa-solid fa-bolt text-xl group-hover:animate-pulse"></i>
                </button>

            </div>
        </div>

        <!-- Loading State -->
        <div id="loader" class="hidden mt-10 text-center">
            <div class="relative inline-flex">
                <div class="w-12 h-12 rounded-full border-4 border-brand-red/20 border-t-brand-red animate-spin"></div>
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="w-2 h-2 bg-brand-red rounded-full animate-pulse"></div>
                </div>
            </div>
            <p class="text-sm text-gray-400 mt-4 tracking-widest uppercase animate-pulse">Extracting Metadata...</p>
        </div>

        <!-- Result Section -->
        <div id="resultCard" class="hidden w-full max-w-3xl mt-8 animate-fade-in-up">
            <div class="glass-panel rounded-3xl p-6 flex flex-col md:flex-row gap-8 bg-[#0F0F0F]/80">
                
                <!-- Thumbnail -->
                <div class="w-full md:w-5/12 relative group rounded-2xl overflow-hidden shadow-2xl border border-white/5">
                    <img id="thumb" src="" class="w-full h-full object-cover aspect-video bg-gray-900 transform group-hover:scale-105 transition duration-700">
                    <div class="absolute inset-0 bg-black/40 group-hover:bg-black/20 transition-colors flex items-center justify-center">
                        <div class="w-14 h-14 bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/20 group-hover:scale-110 transition duration-300">
                            <i class="fa-solid fa-play text-2xl text-white ml-1"></i>
                        </div>
                    </div>
                </div>

                <!-- Content -->
                <div class="flex-1 flex flex-col">
                    <div class="mb-4">
                        <div class="flex justify-between items-start mb-2">
                            <span id="platformBadge" class="text-[10px] font-bold px-2 py-1 rounded bg-red-600 text-white uppercase tracking-wider shadow-[0_0_10px_rgba(220,38,38,0.4)]">YouTube</span>
                            <span class="text-[10px] text-green-400 font-mono border border-green-500/30 px-2 py-0.5 rounded bg-green-500/10">● Ready</span>
                        </div>
                        <h3 id="videoTitle" class="font-bold text-xl leading-snug line-clamp-2 mb-1 text-white">Video Title Goes Here</h3>
                        <p id="videoAuthor" class="text-xs text-gray-500 font-medium flex items-center gap-1">
                            <i class="fa-solid fa-user-circle"></i> <span class="opacity-80">Channel Name</span>
                        </p>
                    </div>

                    <div class="h-px bg-gradient-to-r from-transparent via-white/10 to-transparent mb-5"></div>

                    <h4 class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-3">Available Formats</h4>
                    
                    <!-- Buttons Container -->
                    <div id="downloadButtons" class="grid grid-cols-1 sm:grid-cols-2 gap-3 max-h-52 overflow-y-auto pr-2 custom-scrollbar flex-grow content-start">
                        <!-- Buttons injected via JS -->
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="text-center py-8 text-gray-600 text-xs border-t border-white/5 bg-black/20 backdrop-blur-sm">
        <p class="tracking-widest">&copy; 2024 NECXY CORP • PREMIUM EDITION</p>
    </footer>

    <!-- Scripts -->
    <script>
        // API CONFIGURATION
        const RAPID_API_KEY = "7a77e5ee86msh0a58908122661d0p13bc09jsn5c76755fd90d";
        
        // Hosts
        const YT_HOST = "youtube-media-downloader.p.rapidapi.com";
        const IG_HOST = "instagram-downloader-download-instagram-stories-videos4.p.rapidapi.com";

        let currentPlatform = 'yt';

        // Tab Switching
        function switchTab(platform) {
            currentPlatform = platform;
            const indicator = document.getElementById('tab-indicator');
            const input = document.getElementById('urlInput');
            const btnYt = document.getElementById('btn-yt');
            const btnIg = document.getElementById('btn-ig');

            // Reset UI
            document.getElementById('resultCard').classList.add('hidden');
            input.value = '';

            if (platform === 'yt') {
                indicator.style.transform = 'translateX(0)';
                indicator.style.background = '#FF0033';
                indicator.style.boxShadow = '0 0 15px rgba(255,0,51,0.4)';
                
                input.placeholder = "Paste YouTube Link here...";
                btnYt.classList.remove('text-gray-500');
                btnYt.classList.add('text-white');
                btnIg.classList.add('text-gray-500');
                btnIg.classList.remove('text-white');
            } else {
                indicator.style.transform = 'translateX(100%)'; 
                indicator.style.left = '6px'; 
                indicator.style.transform = 'translateX(100%)'; 
                
                indicator.style.background = 'linear-gradient(to right, #833ab4, #fd1d1d, #fcb045)';
                indicator.style.boxShadow = '0 0 15px rgba(253, 29, 29, 0.4)';

                input.placeholder = "Paste Instagram Link here...";
                btnIg.classList.remove('text-gray-500');
                btnIg.classList.add('text-white');
                btnYt.classList.add('text-gray-500');
                btnYt.classList.remove('text-white');
            }
        }

        async function pasteLink() {
            try {
                const text = await navigator.clipboard.readText();
                document.getElementById('urlInput').value = text;
            } catch (err) {
                alert("Clipboard permission denied. Please press Ctrl+V");
            }
        }

        function extractYouTubeID(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        async function processLink() {
            const url = document.getElementById('urlInput').value.trim();
            if (!url) return alert("Please enter a URL");

            // UI Loading State
            const loader = document.getElementById('loader');
            const resultCard = document.getElementById('resultCard');
            const btn = document.getElementById('generateBtn');
            const icon = btn.querySelector('i');
            
            loader.classList.remove('hidden');
            resultCard.classList.add('hidden');
            btn.disabled = true;
            btn.classList.add('opacity-50', 'cursor-not-allowed');
            icon.classList.remove('fa-bolt');
            icon.classList.add('fa-spinner', 'fa-spin');

            try {
                if (currentPlatform === 'yt') {
                    await handleYouTube(url);
                } else {
                    await handleInstagram(url);
                }
            } catch (error) {
                console.error(error);
                alert("Error fetching data: " + error.message);
            } finally {
                loader.classList.add('hidden');
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
                icon.classList.add('fa-bolt');
                icon.classList.remove('fa-spinner', 'fa-spin');
            }
        }

        // --- YouTube Handler ---
        async function handleYouTube(url) {
            const videoId = extractYouTubeID(url);
            if (!videoId) throw new Error("Invalid YouTube URL");

            const options = {
                method: 'GET',
                headers: {
                    'x-rapidapi-key': RAPID_API_KEY,
                    'x-rapidapi-host': YT_HOST
                }
            };

            const response = await fetch(`https://${YT_HOST}/v2/video/details?videoId=${videoId}`, options);
            const data = await response.json();

            if (!data || !data.title) throw new Error("Failed to get video details");

            // Update UI
            document.getElementById('thumb').src = data.thumbnails?.[data.thumbnails.length - 1]?.url || `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
            document.getElementById('videoTitle').innerText = data.title;
            document.getElementById('videoAuthor').innerHTML = `<i class="fa-solid fa-user-circle"></i> ${data.channelName || "Unknown Channel"}`;
            
            const badge = document.getElementById('platformBadge');
            badge.innerText = "YouTube";
            badge.className = "text-[10px] font-bold px-2 py-1 rounded bg-red-600 text-white uppercase tracking-wider shadow-[0_0_10px_rgba(220,38,38,0.4)]";

            const container = document.getElementById('downloadButtons');
            container.innerHTML = '';

            // Render Videos
            if (data.videos && data.videos.items) {
                data.videos.items.forEach(item => {
                    if (item.url) {
                        const btn = createDownloadBtn(item.quality || 'Video', 'MP4', item.url, 'fa-video');
                        container.appendChild(btn);
                    }
                });
            }

            // Render Audios
            if (data.audios && data.audios.items) {
                 data.audios.items.forEach(item => {
                    if (item.url) {
                        const btn = createDownloadBtn(item.quality || 'Audio', 'MP3', item.url, 'fa-music', true);
                        container.appendChild(btn);
                    }
                });
            }

            resultCard.classList.remove('hidden');
        }

        // --- Instagram Handler ---
        async function handleInstagram(url) {
            const encodedUrl = encodeURIComponent(url);
            const options = {
                method: 'GET',
                headers: {
                    'x-rapidapi-key': RAPID_API_KEY,
                    'x-rapidapi-host': IG_HOST
                }
            };

            const response = await fetch(`https://${IG_HOST}/convert?url=${encodedUrl}`, options);
            const data = await response.json();
            
            let downloadUrl = null;
            let thumbUrl = "https://images.unsplash.com/photo-1611162616305-c69b3fa7fbe0?w=500"; 
            let title = "Instagram Media";

            if (data.url && Array.isArray(data.url)) {
                downloadUrl = data.url[0].url; // Usually sorted by quality
                thumbUrl = data.thumb || thumbUrl;
                title = data.meta?.title || title;
            } else if (typeof data === 'string') {
                 // Check if string is URL
            } else if (data.url) {
                downloadUrl = data.url;
            } else if (data.data && data.data.url) {
                downloadUrl = data.data.url;
            }

            if (!downloadUrl && Array.isArray(data)) {
                downloadUrl = data[0]?.url;
            }

            if (!downloadUrl) {
                console.log("IG Data:", data);
                if(data.message) throw new Error(data.message);
                throw new Error("No download link found in response.");
            }

            // Update UI
            document.getElementById('thumb').src = thumbUrl;
            document.getElementById('videoTitle').innerText = title;
            document.getElementById('videoAuthor').innerHTML = `<i class="fa-brands fa-instagram"></i> Instagram User`;
            
            const badge = document.getElementById('platformBadge');
            badge.innerText = "Instagram";
            badge.className = "text-[10px] font-bold px-2 py-1 rounded bg-gradient-to-r from-purple-500 to-pink-500 text-white uppercase tracking-wider shadow-[0_0_10px_rgba(236,72,153,0.4)]";

            const container = document.getElementById('downloadButtons');
            container.innerHTML = '';

            const btn = createDownloadBtn('High Quality', 'MP4', downloadUrl, 'fa-instagram');
            container.appendChild(btn);
            
            resultCard.classList.remove('hidden');
        }

        function createDownloadBtn(quality, format, url, iconClass, isAudio = false) {
            const btn = document.createElement('a');
            btn.href = url;
            btn.target = "_blank"; 
            
            const colorClass = isAudio 
                ? 'text-green-400 border-green-500/20 hover:border-green-500/50 hover:bg-green-500/5' 
                : 'text-gray-200 border-white/10 hover:border-brand-red/50 hover:bg-white/5';

            btn.className = `download-btn flex items-center justify-between p-3.5 rounded-xl border ${colorClass} group cursor-pointer transition-all duration-300`;
            
            btn.innerHTML = `
                <div class="flex items-center gap-3">
                    <div class="w-9 h-9 rounded-lg bg-white/5 flex items-center justify-center group-hover:bg-brand-red group-hover:text-white transition-colors duration-300">
                        <i class="fa-solid ${iconClass} text-sm"></i>
                    </div>
                    <div class="text-left">
                        <p class="text-xs font-bold">${quality}</p>
                        <p class="text-[10px] text-gray-500 font-mono tracking-wider group-hover:text-gray-300">${format}</p>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full flex items-center justify-center border border-white/10 group-hover:border-brand-red group-hover:text-brand-red transition-all">
                    <i class="fa-solid fa-download text-xs"></i>
                </div>
            `;
            
            return btn;
        }
    </script>
</body>
</html>


